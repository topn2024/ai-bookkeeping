# 专利文档格式转换指南

**目的**: 将Markdown格式的专利文档转换为符合国家知识产权局要求的Word格式

**生成日期**: 2026-01-19

---

## 一、国家知识产权局文档格式要求

### 1.1 基本要求

- **文件格式**: Word文档（.doc或.docx）
- **纸张**: A4纸（210mm × 297mm）
- **页边距**: 上25mm、下25mm、左25mm、右25mm
- **字体**: 宋体或黑体
- **字号**:
  - 标题：小二号或三号字
  - 正文：小四号或五号字
- **行距**: 1.5倍或固定值20磅
- **页码**: 底部居中

### 1.2 权利要求书格式

```
权利要求书

1. 一种[发明名称]，其特征在于，包括以下步骤：
   S1. [步骤1描述]；
   S2. [步骤2描述]；
   ...

2. 根据权利要求1所述的[发明名称]，其特征在于，所述[步骤1]中，[详细描述]。

3. 根据权利要求1所述的[发明名称]，其特征在于，所述[步骤2]中，[详细描述]。

...
```

### 1.3 说明书格式

```
说明书

[发明名称]

技术领域

[技术领域描述]

背景技术

[背景技术描述]

发明内容

[发明内容描述]

附图说明

图1是...
图2是...

具体实施方式

[具体实施方式描述]
```

### 1.4 说明书摘要格式

```
说明书摘要

[摘要内容，200-300字]
```

---

## 二、转换步骤

### 2.1 手动转换（推荐用于重要专利）

**步骤1: 创建Word文档**
1. 打开Microsoft Word
2. 新建空白文档
3. 设置页面格式：
   - 页面布局 → 页边距 → 自定义页边距
   - 上下左右均设置为25mm

**步骤2: 设置字体和段落**
1. 选择全文（Ctrl+A）
2. 设置字体：宋体
3. 设置字号：小四号（12磅）
4. 设置行距：1.5倍行距

**步骤3: 复制内容**
1. 打开Markdown文件（如`claims.md`）
2. 复制内容到Word文档
3. 调整格式：
   - 删除Markdown标记（#、**、-等）
   - 调整标题格式（加粗、字号）
   - 调整列表格式（编号、缩进）

**步骤4: 添加页眉页脚**
1. 插入 → 页眉 → 空白
2. 输入专利名称
3. 插入 → 页脚 → 页码 → 底部居中

**步骤5: 检查和保存**
1. 检查格式是否符合要求
2. 检查内容是否完整
3. 另存为Word文档（.docx）

### 2.2 使用Pandoc转换（快速批量转换）

**安装Pandoc**:
```bash
# macOS
brew install pandoc

# 或下载安装包
# https://pandoc.org/installing.html
```

**转换命令**:
```bash
# 转换单个文件
pandoc claims.md -o claims.docx

# 转换所有专利的权利要求书
for dir in /Users/beihua/code/baiji/ai-bookkeeping/docs/patents/patents/P*; do
  patent=$(basename "$dir")
  pandoc "$dir/claims.md" -o "$dir/${patent}-权利要求书.docx"
  pandoc "$dir/specification.md" -o "$dir/${patent}-说明书.docx"
  pandoc "$dir/abstract.md" -o "$dir/${patent}-摘要.docx"
done
```

**转换后需要手动调整**:
1. 页边距（25mm）
2. 字体（宋体）
3. 字号（小四号）
4. 行距（1.5倍）
5. 页眉页脚

### 2.3 使用在线转换工具（不推荐）

**原因**:
- 格式可能不符合要求
- 可能泄露专利内容
- 需要手动大量调整

---

## 三、各文档转换要点

### 3.1 权利要求书转换

**Markdown格式**:
```markdown
# 权利要求书

## 权利要求1

一种LLM增强的四维语音交互方法，其特征在于，包括以下步骤：

S1. 四维交互框架构建步骤：...
S2. LLM优先混合识别步骤：...
```

**Word格式**:
```
权利要求书

1. 一种LLM增强的四维语音交互方法，其特征在于，包括以下步骤：
   S1. 四维交互框架构建步骤：...
   S2. LLM优先混合识别步骤：...
```

**转换要点**:
- 删除Markdown标题标记（#）
- 将"## 权利要求1"改为"1."
- 保持缩进和编号
- 确保每个权利要求独立成段

### 3.2 说明书转换

**Markdown格式**:
```markdown
# [发明名称]

## 技术领域

本发明涉及...

## 背景技术

随着...
```

**Word格式**:
```
说明书

[发明名称]

技术领域

本发明涉及...

背景技术

随着...
```

**转换要点**:
- 删除Markdown标题标记（#）
- 保持章节结构
- 调整标题字号（三号字、加粗）
- 保持正文字号（小四号）

### 3.3 摘要转换

**Markdown格式**:
```markdown
# 摘要

本发明公开了一种...
```

**Word格式**:
```
说明书摘要

本发明公开了一种...
```

**转换要点**:
- 删除Markdown标题标记
- 标题改为"说明书摘要"
- 字数控制在200-300字

---

## 四、批量转换脚本

### 4.1 使用Pandoc批量转换

创建转换脚本 `convert_patents.sh`:

```bash
#!/bin/bash

# 专利文档批量转换脚本
# 使用方法: ./convert_patents.sh

PATENTS_DIR="/Users/beihua/code/baiji/ai-bookkeeping/docs/patents/patents"

echo "开始转换专利文档..."

for dir in "$PATENTS_DIR"/P*; do
  if [ -d "$dir" ]; then
    patent=$(basename "$dir")
    echo "转换 $patent..."

    # 转换权利要求书
    if [ -f "$dir/claims.md" ]; then
      pandoc "$dir/claims.md" \
        --reference-doc=template.docx \
        -o "$dir/${patent}-权利要求书.docx"
      echo "  ✅ 权利要求书"
    fi

    # 转换说明书
    if [ -f "$dir/specification.md" ]; then
      pandoc "$dir/specification.md" \
        --reference-doc=template.docx \
        -o "$dir/${patent}-说明书.docx"
      echo "  ✅ 说明书"
    fi

    # 转换摘要
    if [ -f "$dir/abstract.md" ]; then
      pandoc "$dir/abstract.md" \
        --reference-doc=template.docx \
        -o "$dir/${patent}-摘要.docx"
      echo "  ✅ 摘要"
    fi
  fi
done

echo "转换完成！"
```

**使用方法**:
```bash
chmod +x convert_patents.sh
./convert_patents.sh
```

### 4.2 创建Word模板

**步骤**:
1. 创建一个Word文档 `template.docx`
2. 设置页边距（25mm）
3. 设置默认字体（宋体、小四号）
4. 设置默认行距（1.5倍）
5. 保存模板

**使用模板**:
```bash
pandoc input.md --reference-doc=template.docx -o output.docx
```

---

## 五、质量检查清单

### 5.1 格式检查

- [ ] 页边距：上下左右均为25mm
- [ ] 字体：宋体
- [ ] 字号：标题三号、正文小四号
- [ ] 行距：1.5倍
- [ ] 页码：底部居中
- [ ] 页眉：专利名称

### 5.2 内容检查

- [ ] 标题完整
- [ ] 章节结构清晰
- [ ] 编号正确（权利要求1、2、3...）
- [ ] 公式显示正确
- [ ] 表格格式正确
- [ ] 无Markdown标记残留

### 5.3 完整性检查

- [ ] 权利要求书完整
- [ ] 说明书完整
- [ ] 摘要完整
- [ ] 附图清单完整
- [ ] 无缺页、漏页

---

## 六、常见问题

### Q1: Pandoc转换后格式不对怎么办？

**A**: 使用Word模板（--reference-doc参数）可以解决大部分格式问题。如果仍有问题，建议手动调整。

### Q2: 如何处理代码块？

**A**: 专利文档中的代码块应该转换为普通文本，使用等宽字体（如Courier New）显示。

### Q3: 如何处理数学公式？

**A**:
- 简单公式：直接使用文本表示
- 复杂公式：使用Word公式编辑器（插入 → 公式）

### Q4: 如何处理表格？

**A**: Markdown表格会自动转换为Word表格，但需要手动调整：
- 表格宽度
- 单元格对齐
- 边框样式

### Q5: 转换后中文显示乱码怎么办？

**A**:
1. 确保Markdown文件使用UTF-8编码
2. 使用Pandoc时指定编码：`pandoc -f markdown+east_asian_line_breaks`

---

## 七、推荐工具

### 7.1 文档转换

- **Pandoc**: 命令行工具，支持多种格式转换
- **Microsoft Word**: 手动编辑和格式调整
- **WPS Office**: 国产办公软件，兼容性好

### 7.2 格式检查

- **Adobe Acrobat**: PDF格式检查
- **Word内置检查**: 拼写和语法检查

### 7.3 批量处理

- **Bash脚本**: 批量转换
- **Python脚本**: 自定义转换逻辑

---

## 八、时间估算

### 8.1 手动转换

- 单个专利：30-60分钟
- 18个专利：9-18小时

### 8.2 使用Pandoc

- 单个专利：5-10分钟（转换+调整）
- 18个专利：1.5-3小时

### 8.3 建议

- 高优先级专利（5个）：手动转换，确保质量
- 中低优先级专利（13个）：使用Pandoc批量转换，再手动调整

---

## 九、下一步

转换完成后：

1. ✅ 检查格式是否符合要求
2. ✅ 检查内容是否完整
3. ⏳ 准备附图文件
4. ⏳ 填写专利申请请求书
5. ⏳ 提交专利申请

---

**提示**: 建议先转换1-2个专利进行测试，确认格式无误后再批量转换其他专利。
