# 权利要求书

## 基于多算法融合的消费趋势预测和洞察生成方法及系统

### 独立权利要求

**权利要求1**：一种基于多算法融合的消费趋势预测方法，其特征在于，包括以下步骤：

S1. 多算法融合预测步骤：
- 采用简单移动平均（SMA）、加权移动平均（WMA）、指数移动平均（EMA）和线性回归四种算法进行并行预测；
- SMA计算公式：SMA_6 = mean(last_6_months)，权重0.2；
- WMA计算公式：WMA = Σ(amount[i] × weight[i])，权重序列[0.5, 0.33, 0.17]，权重0.3；
- EMA计算公式：EMA[t] = α × amount[t] + (1-α) × EMA[t-1]，平滑系数α=0.3，权重0.2；
- 线性回归计算公式：y = a × t + b，拟合趋势斜率a，权重0.3；
- 融合预测公式：base_prediction = 0.2×SMA_6 + 0.3×WMA + 0.2×EMA + 0.3×trend_prediction；
- 计算时间小于50ms，适合移动端实时计算；

S2. 中国市场季节性调整步骤：
- 计算12个月季节性因子，公式：seasonal_factor[month] = monthly_avg[month] / yearly_avg；
- 应用中国市场特殊因子：1月（元旦）1.1、2月（春节）1.3、3月（春节后回落）0.9、6月（618促销）1.2、11月（双11）1.4、12月（双12及年终）1.2；
- 平滑处理：将因子裁剪到[0.7, 1.5]范围，避免极端值；
- 动态更新：new_factor = 0.7 × old_factor + 0.3 × actual_factor；
- 最终预测：final_prediction = base_prediction × seasonal_factor；
- 季节性适应使预测误差降低30%；

S3. 置信区间计算步骤：
- 计算历史预测误差的标准差：std_error = std(errors)；
- 使用正态分布95%置信度，z_score = 1.96；
- 计算置信区间：lower_bound = prediction - 1.96×std_error，upper_bound = prediction + 1.96×std_error；
- 置信度评估：data_quality = min(历史月数/12, 1.0)，stability = 1 - min(变异系数, 1.0)，confidence = 0.5×data_quality + 0.5×stability；
- 置信度等级：高（大于0.8）、中（0.6-0.8）、低（小于0.6）；
- 置信区间覆盖率大于95%；

S4. 消费洞察生成步骤：
- 拿铁因子检测：当小额消费（小于50元）占比大于30%时，生成节约建议"每月可节省{saved_amount}元"；
- 周末消费模式分析：当周末消费占比大于50%时，建议"周末前规划预算"；
- 异常大额消费识别：当单笔消费大于1000元时，提醒"建议提前规划大额支出"；
- 消费趋势分析：当月均增长大于10%时，警示"建议控制支出增长"；
- 分类消费洞察：展示Top3消费分类及占比；
- 平均生成5.2条洞察/用户；

S5. 预算超支预警步骤：
- 计算消费速度：spending_rate = 当前消费 / 已过天数；
- 预测月末消费：projected_spending = spending_rate × 当月总天数；
- 进度比较：time_progress = 已过天数/当月总天数，spending_progress = 当前消费/预算；
- 预警判定：当spending_progress > time_progress + 0.2时为严重预警，当spending_progress > time_progress + 0.1时为警告；
- 建议限额：daily_limit = (预算 - 当前消费) / 剩余天数；
- 提前7天预警：当剩余天数等于7且预计超支时发送通知；
- 预警及时率大于98%。

**权利要求2**：一种基于多算法融合的消费趋势预测系统，其特征在于，包括：

多算法融合引擎：用于并行执行SMA、WMA、EMA和线性回归四种预测算法，采用固定权重0.2、0.3、0.2、0.3进行融合，计算时间小于50ms；

中国市场季节性模块：用于计算和应用包含中国特有促销节日的季节性因子，春节因子1.3、双11因子1.4，动态更新因子；

置信区间计算模块：用于计算95%置信区间并评估预测可靠性，置信区间覆盖率大于95%；

消费洞察生成模块：用于分析消费模式并生成5类可操作建议，平均生成5.2条洞察/用户；

预算超支预警模块：用于提前7天预警预算超支，预警及时率大于98%。

### 从属权利要求

**权利要求3**：根据权利要求1所述的方法，其特征在于，所述多算法融合预测步骤的具体实现为：

- SMA_3 = (amount[t-1] + amount[t-2] + amount[t-3]) / 3；
- SMA_6 = (amount[t-1] + ... + amount[t-6]) / 6；
- WMA = 0.5×amount[t-1] + 0.33×amount[t-2] + 0.17×amount[t-3]；
- EMA初始值 = SMA_6，递推公式EMA[t] = 0.3×amount[t] + 0.7×EMA[t-1]；
- 线性回归使用最小二乘法拟合：a = Σ((t-t̄)(y-ȳ)) / Σ((t-t̄)²)，b = ȳ - a×t̄。

**权利要求4**：根据权利要求1所述的方法，其特征在于，所述中国市场特殊因子还包括：

- 五一劳动节（5月）：1.15；
- 国庆节（10月）：1.25；
- 中秋节（农历八月十五对应公历月份）：1.1；
- 因子动态更新：每月根据实际数据更新，new_factor = 0.7×old_factor + 0.3×actual_factor；
- 平滑处理：clip(seasonal_factor, 0.7, 1.5)，避免极端值影响预测。

**权利要求5**：根据权利要求1所述的方法，其特征在于，所述置信度评估的具体实现为：

- 数据质量评分：data_quality = min(历史月数/12, 1.0)，历史数据越多质量越高；
- 稳定性评分：cv = std(History) / mean(History)，stability = 1 - min(cv, 1.0)，变异系数越小稳定性越高；
- 综合置信度：confidence = 0.5×data_quality + 0.5×stability；
- 置信等级划分：高置信度（大于0.8）、中置信度（0.6-0.8）、低置信度（小于0.6）。

**权利要求6**：根据权利要求1所述的方法，其特征在于，所述拿铁因子检测的具体实现为：

- 小额消费定义：单笔金额小于50元；
- 高频判定：月均超过20笔小额消费；
- 占比计算：small_ratio = sum(small_transactions) / sum(History)；
- 节约计算：saved_amount = 小额消费总额 × 0.5；
- 触发条件：当small_ratio > 0.3时生成洞察；
- 洞察文本："您的小额消费占比{small_ratio}%，建议关注'拿铁因子'，每月可节省{saved_amount}元"。

**权利要求7**：根据权利要求1所述的方法，其特征在于，所述预算超支预警的具体实现为：

- 消费速度计算：spending_rate = CurrentSpending / days_passed；
- 预计月末消费：projected_spending = spending_rate × 当月总天数；
- 时间进度：time_progress = days_passed / 当月总天数；
- 消费进度：spending_progress = CurrentSpending / Budget；
- 严重预警判定：if spending_progress > time_progress + 0.2 then alert_level = "严重"；
- 警告预警判定：if spending_progress > time_progress + 0.1 then alert_level = "警告"；
- 建议限额：daily_limit = (Budget - CurrentSpending) / RemainingDays。

**权利要求8**：根据权利要求1所述的方法，其特征在于，还包括动态权重调整步骤：

- 回测评估：计算各算法在近3个月的预测误差；
- 权重更新：误差小的算法增加权重，误差大的算法减少权重；
- 权重约束：任一算法权重在[0.1, 0.5]范围内；
- 更新频率：每月更新一次；
- 权重归一化：确保Σ(weight_i) = 1。

**权利要求9**：根据权利要求1所述的方法，其特征在于，还包括异常值处理步骤：

- 检测方法：z_score = (value - mean) / std，当|z_score| > 3时判定为异常；
- 处理方式：使用中位数替代异常值；
- 标记保留：保留异常标记用于洞察分析；
- 避免异常值影响预测准确率。

**权利要求10**：根据权利要求1所述的方法，其特征在于，还包括个性化消费模式学习步骤：

- 周期消费识别：检测固定周期（周、月、季度）的重复消费模式；
- 固定支出提取：识别房租、会员订阅等固定金额支出；
- 弹性支出分离：将总消费分为固定支出和弹性支出分别预测；
- 预测公式：total_prediction = fixed_prediction + elastic_prediction；
- 提高预测准确率大于5%。

**权利要求11**：根据权利要求2所述的系统，其特征在于，还包括：

分类预测模块：用于对餐饮、购物、娱乐等分类分别进行趋势预测，每个分类独立计算季节性因子和置信区间；

可视化模块：用于展示预测趋势线、置信区间阴影和历史数据对比，提供直观的图表展示；

反馈学习模块：用于根据实际消费数据持续优化模型参数，动态调整算法权重和季节性因子。

**权利要求12**：根据权利要求2所述的系统，其特征在于，还包括：

一种计算机可读存储介质，其上存储有计算机程序，所述程序被处理器执行时实现权利要求1所述的基于多算法融合的消费趋势预测方法。

**权利要求13**：根据权利要求2所述的系统，其特征在于，还包括：

一种电子设备，包括处理器和存储器，所述存储器存储的程序被处理器执行时实现权利要求1所述的基于多算法融合的消费趋势预测方法，所述电子设备为移动终端设备，包括智能手机、平板电脑或智能手表。
