# 权利要求书

## 基于差分隐私的财务智能自学习方法及系统

### 独立权利要求

**权利要求1**：一种基于差分隐私的财务智能自学习方法，其特征在于，包括以下步骤：

S1. 本地自学习步骤：
- 监听用户对分类结果的确认或修改操作；
- 实时更新本地分类规则，建立商户-分类映射表；
- 对交易商户名称进行标准化处理，去除平台前缀和噪声信息；

S2. 差分隐私保护步骤：
- 基于拉普拉斯机制对规则置信度添加噪声，使用逆变换采样公式 X = μ - b × sign(U - 0.5) × ln(1 - 2|U - 0.5|)，其中 b = Δf/ε；
- 根据数据敏感度级别动态分配隐私预算ε，其中高敏感数据使用ε=0.1，中敏感数据使用ε=0.5，低敏感数据使用ε=1.0；
- 对规则模式进行哈希脱敏处理，仅上传哈希值、类型、分类和加噪置信度；

S3. 隐私预算管理步骤：
- 追踪各敏感度级别的预算消耗量；
- 当总消耗达到预算上限时停止数据共享，仅使用本地学习；
- 按配置周期自动重置预算，默认每24小时重置一次；

S4. 轻量级协同学习步骤：
- 将加噪后的规则上传到服务器进行聚合；
- 下载聚合后的高置信度规则用于冷启动。

**权利要求2**：一种基于差分隐私的财务智能自学习系统，其特征在于，包括：

本地自学习模块：用于监听用户反馈，实时更新本地分类规则，标准化商户名称；

差分隐私引擎：用于整合拉普拉斯噪声生成器、敏感度计算器和隐私预算管理器，对规则和查询结果进行隐私保护；

隐私预算管理器：用于管理和追踪差分隐私预算消耗，实现组合定理下的预算累积控制；

协同学习模块：用于上传加噪规则和下载聚合规则。

### 从属权利要求

**权利要求3**：根据权利要求1所述的方法，其特征在于，所述拉普拉斯噪声生成包括：

- 计算尺度参数 b = Δf/ε，其中Δf为查询敏感度，ε为隐私参数；
- 生成均匀分布随机数U∈(0,1)，排除边界值避免ln(0)问题；
- 使用逆变换采样计算噪声 X = μ - b × sign(U - 0.5) × ln(1 - 2|U - 0.5|)；
- 噪声方差为 2b²，标准差为 √(2)b。

**权利要求4**：根据权利要求1所述的方法，其特征在于，所述敏感度级别划分基于隐私-效用权衡理论，包括：

- 高敏感数据：金额、商户等财务核心信息，ε = 0.1，提供约e^0.1 ≈ 1.105倍的概率保护，效用保留率约60%，参考金融数据高敏感性特点及Apple敏感数据策略；
- 中敏感数据：分类规则置信度等，ε = 0.5，提供约e^0.5 ≈ 1.649倍的概率保护，效用保留率约85%，平衡隐私保护与学习效果；
- 低敏感数据：统计信息、计数查询等，ε = 1.0，提供约e^1.0 ≈ 2.718倍的概率保护，效用保留率约95%，参考Google RAPPOR系统实践。

**权利要求5**：根据权利要求1所述的方法，其特征在于，所述隐私预算管理包括：

- 初始化总预算上限，默认为10.0；
- 每次隐私保护操作前检查剩余预算是否充足；
- 记录每次消耗的epsilon值、敏感度级别、操作描述和时间戳；
- 预算耗尽时触发回调通知并停止协同学习；
- 支持手动重置和周期自动重置。

**权利要求6**：根据权利要求1所述的方法，其特征在于，所述规则保护步骤包括：

- 计算置信度敏感度，置信度范围[0,1]对应敏感度为1；
- 对规则模式字符串进行哈希计算，生成8位十六进制哈希值；
- 添加噪声后将置信度裁剪到[0,1]范围；
- 生成隐私规则对象，包含模式哈希、类型、分类、加噪置信度，不包含原始模式和精确置信度。

**权利要求7**：根据权利要求1所述的方法，其特征在于，还包括数值数据保护步骤：

- 保护单个数值：使用数值范围计算敏感度，添加噪声后应用边界约束；
- 保护均值查询：敏感度为(max-min)/n，其中n为记录数；
- 保护计数查询：敏感度为1，噪声结果四舍五入为整数；
- 保护直方图：对每个桶独立添加噪声，累积消耗预算。

**权利要求8**：根据权利要求1所述的方法，其特征在于，所述商户识别算法包括：

- 去除平台前缀：识别并去除"美团"、"饿了么"、"淘宝"等前缀；
- 去除订单号和时间戳等噪声信息；
- 提取核心商户名称；
- 建立商户别名映射表。

**权利要求9**：根据权利要求2所述的系统，其特征在于，所述差分隐私引擎还包括：

- 批量规则保护功能：依次对多个规则进行保护，预算耗尽时停止；
- 预算估算功能：根据规则数量和敏感度级别估算所需预算；
- 预算充足性检查：操作前验证是否有足够预算完成保护。

**权利要求10**：根据权利要求2所述的系统，其特征在于，所述隐私预算管理器还包括：

- 分级消耗统计：分别统计高、中、低敏感度级别的消耗量和操作次数；
- 持久化存储接口：支持将预算状态、配置和消耗历史保存到存储介质；
- 预算耗尽监听器：注册回调函数在预算耗尽时触发；
- 剩余预算查询：提供剩余预算绝对值和百分比。
