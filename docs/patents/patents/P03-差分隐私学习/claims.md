# 权利要求书

## 基于差分隐私的财务智能自学习方法及系统

### 独立权利要求

**权利要求1**：一种基于差分隐私的财务分类智能自学习方法，其特征在于，包括以下步骤：

S1. 本地增量学习步骤：
- 采用增量学习算法监听用户对分类结果的确认或修改操作，学习响应时间小于50ms；
- 当用户确认分类时，将规则置信度增加0.1，使用次数加1；当用户修改分类时，将原规则置信度减少0.2，创建新规则初始置信度为0.8；
- 采用规则优先级算法计算priority = confidence × log(usage_count + 1)，规则更新准确率大于95%；
- 对交易商户名称进行标准化处理，去除"美团"、"饿了么"、"淘宝"等平台前缀和噪声信息，标准化响应时间小于30ms，商户识别准确率大于90%；
- 分类准确率大于85%，相比纯规则引擎（准确率小于70%）提升15个百分点以上；

S2. 差分隐私保护步骤：
- 采用拉普拉斯机制对规则置信度添加噪声，使用逆变换采样公式 X = -b × sign(U-0.5) × ln(1-2|U-0.5|)，其中敏感度Δf=1，尺度参数b=Δf/ε；
- 根据数据敏感度级别动态分配隐私预算ε：高敏感数据（金额、商户）使用ε=0.1，中敏感数据（规则置信度）使用ε=0.5，低敏感数据（统计计数）使用ε=1.0；
- 对规则模式进行哈希脱敏处理，生成8位十六进制哈希值，仅上传哈希值、类型、分类和加噪置信度，不上传原始商户名称；
- 隐私泄露风险小于0.1%，数据效用保留率大于85%，相比中心化协同学习（隐私泄露风险大于25%）降低99.6%；

S3. 规则级协同学习步骤：
- 采用规则级协同学习算法，仅交换规则不交换原始交易数据，规则上传大小小于100KB；
- 服务器端采用加权平均算法聚合多个用户的相似规则，权重为usage_count，聚合置信度计算公式为Σ(confidence_i × usage_count_i) / Σ(usage_count_i)；
- 通信开销降低大于95%，协同学习收敛速度提升大于3倍，相比模型级协同学习（上传大小大于10MB）降低99%；

S4. 恶意检测步骤：
- 采用统计异常检测算法，计算规则集中位数median_conf和标准差σ；
- 计算新规则偏离度deviation = |r.confidence - median_conf|，当deviation > 3σ时判定为异常规则；
- 当用户提交异常规则数大于3时，标记为恶意用户并隔离该用户；
- 检测准确率大于90%，误报率小于10%，恶意数据污染率小于5%，相比现有技术（检测准确率小于60%）提升30个百分点以上。

**权利要求2**：一种基于差分隐私的财务分类智能自学习系统，其特征在于，包括：

本地增量学习引擎：用于监听用户反馈，采用增量学习算法实时更新本地分类规则，学习响应时间小于50ms，规则更新准确率大于95%，标准化商户名称响应时间小于30ms；

差分隐私保护引擎：用于整合拉普拉斯噪声生成器、敏感度计算器和隐私预算管理器，采用逆变换采样方法生成拉普拉斯噪声，隐私泄露风险小于0.1%，数据效用保留率大于85%；

规则级协同学习模块：用于上传加噪规则和下载聚合规则，规则上传大小小于100KB，通信开销降低大于95%，协同学习收敛速度提升大于3倍；

恶意检测模块：用于采用3σ原则检测异常规则，检测准确率大于90%，误报率小于10%，恶意数据污染率小于5%。

### 从属权利要求

**权利要求3**：根据权利要求1所述的方法，其特征在于，还包括冷启动加速步骤：

- 检测新用户（使用天数小于7天），自动获取高置信度协同规则（置信度大于等于0.8，使用次数大于等于10）；
- 下载规则数量为500条，下载时间小于2秒；
- 新用户首次交易分类准确率大于75%，达到80%准确率所需交易次数小于30次，学习时间小于10天；
- 相比纯本地学习（新用户准确率小于50%，需要大于100次交易）提升25个百分点以上，学习时间缩短66.7%。

**权利要求4**：根据权利要求1所述的方法，其特征在于，所述规则级协同学习步骤还包括规则相似度计算：

- 计算商户名称相似度、分类一致性和置信度相似度；
- 综合相似度 = 0.3×商户名称相似度 + 0.4×分类一致性 + 0.3×置信度相似度；
- 当综合相似度大于0.9时，将多个用户的规则聚合为一条规则；
- 聚合后规则置信度采用加权平均，权重为各规则的使用次数。

**权利要求5**：根据权利要求1所述的方法，其特征在于，所述隐私预算管理包括：

- 初始化总预算上限为10.0；
- 每次隐私保护操作前检查剩余预算是否充足；
- 记录每次消耗的epsilon值、敏感度级别、操作描述和时间戳；
- 预算耗尽时触发回调通知并停止协同学习；
- 支持手动重置和周期自动重置，默认每24小时重置一次。

**权利要求6**：根据权利要求1所述的方法，其特征在于，所述增量学习算法的具体实现为：

- 当用户确认分类时，执行R'.confidence += 0.1和R'.usage_count += 1；
- 当用户修改分类时，执行R_old.confidence -= 0.2，并创建新规则R_new = {pattern: T.merchant, category: F.new_category, confidence: 0.8}；
- 规则优先级计算公式为priority = confidence × log(usage_count + 1)；
- 规则更新操作在50ms内完成，确保实时响应用户操作。

**权利要求7**：根据权利要求1所述的方法，其特征在于，所述商户标准化算法包括：

- 识别并去除"美团外卖"、"饿了么"、"淘宝"、"京东"等平台前缀；
- 去除订单号（数字序列）和时间戳等噪声信息；
- 提取核心商户名称，标准化响应时间小于30ms；
- 建立商户别名映射表，将"星巴克咖啡"、"Starbucks"等统一为"星巴克"。

**权利要求8**：根据权利要求1所述的方法，其特征在于，所述恶意检测算法的具体实现为：

- 计算规则集中位数median_conf = median(R.confidence)；
- 计算规则集标准差σ = std(R.confidence)；
- 计算新规则偏离度deviation = |r.confidence - median_conf|；
- 当deviation > 3σ时判定为异常规则；
- 当用户提交异常规则数大于等于3时，标记为恶意用户并从协同学习网络中移除。

**权利要求9**：根据权利要求2所述的系统，其特征在于，所述差分隐私保护引擎还包括：

- 拉普拉斯噪声生成器：采用逆变换采样方法，生成均匀分布随机数U∈(0,1)，计算噪声X = -b × sign(U-0.5) × ln(1-2|U-0.5|)；
- 敏感度计算器：根据数据类型自动计算敏感度Δf，置信度范围[0,1]对应敏感度为1；
- 边界裁剪器：将加噪后的置信度裁剪到[0,1]范围，确保数据有效性。

**权利要求10**：根据权利要求2所述的系统，其特征在于，还包括：

一种计算机可读存储介质，其上存储有计算机程序，所述程序被处理器执行时实现权利要求1所述的基于差分隐私的财务分类智能自学习方法。

**权利要求11**：根据权利要求2所述的系统，其特征在于，还包括：

一种电子设备，包括处理器和存储器，所述存储器存储的程序被处理器执行时实现权利要求1所述的基于差分隐私的财务分类智能自学习方法，所述电子设备为移动终端设备，包括智能手机、平板电脑或智能手表。
