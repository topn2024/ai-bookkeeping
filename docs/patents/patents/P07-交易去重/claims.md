# 权利要求书

## 多因子交易去重方法及系统

### 独立权利要求

**权利要求1**：一种多因子交易去重方法，其特征在于，包括以下步骤：

S1. 特征向量提取步骤：
- 提取待检测交易的六维特征向量；
- 所述特征包括：金额、时间、商户、类别、描述、来源；

S2. 候选匹配检索步骤：
- 在历史交易库中检索金额相近且时间接近的候选交易；
- 快速预筛选条件：时间窗口±5分钟，金额差异<5%；

S3. 六因子评分计算步骤：
- 金额因子：计算金额差异百分比，权重0.25；
- 时间因子：计算时间间隔评分，权重0.20；
- 商户因子：计算商户名称相似度，权重0.20；
- 类别因子：计算消费类别匹配度，权重0.15；
- 描述因子：计算交易描述相似度，权重0.10；
- 来源因子：计算数据来源关联性，权重0.10；

S4. 去重决策步骤：
- 总相似度 = Σ(因子得分 × 因子权重)；
- 相似度>0.9：自动标记为重复交易；
- 相似度0.7-0.9：提示用户确认；
- 相似度≤0.7：视为不同交易。

**权利要求2**：一种多因子交易去重系统，其特征在于，包括：

特征提取模块：用于提取交易的六维特征向量；

候选检索模块：用于从历史交易库中快速检索候选匹配；

评分计算模块：用于计算六因子相似度评分；

去重决策模块：用于基于阈值判断并处理重复交易。

### 从属权利要求

**权利要求3**：根据权利要求1所述的方法，其特征在于，所述金额因子评分计算为：

- 金额差异率 = |金额A - 金额B| / max(金额A, 金额B)；
- 差异率<1%：评分1.0；
- 差异率1-5%：评分0.8；
- 差异率5-10%：评分0.5；
- 差异率>10%：评分0。

**权利要求4**：根据权利要求1所述的方法，其特征在于，所述时间因子评分计算为：

- 时间差 = |时间A - 时间B|；
- 时间差<1分钟：评分1.0；
- 时间差1-5分钟：评分0.9；
- 时间差5-30分钟：评分0.7；
- 时间差30分钟-1小时：评分0.5；
- 时间差>1小时：评分0.2。

**权利要求5**：根据权利要求1所述的方法，其特征在于，所述商户因子评分使用编辑距离算法：

- 计算商户名称的Levenshtein编辑距离；
- 相似度 = 1 - 编辑距离 / max(长度A, 长度B)；
- 处理常见商户别名和简称。

**权利要求6**：根据权利要求1所述的方法，其特征在于，所述来源因子评分包括：

- 同来源（如都是支付宝）：评分0.3；
- 关联来源（如支付宝和银行卡联动）：评分0.8；
- 不同来源（如支付宝和微信）：评分1.0。

**权利要求7**：根据权利要求1所述的方法，其特征在于，还包括智能合并步骤：

- 对确认为重复的交易进行智能合并；
- 保留信息更完整的交易记录；
- 记录合并来源以便追溯。

**权利要求8**：根据权利要求2所述的系统，其特征在于，所述候选检索模块采用索引优化：

- 建立金额范围索引；
- 建立时间窗口索引；
- 支持快速范围查询。
