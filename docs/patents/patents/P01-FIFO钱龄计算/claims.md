# 权利要求书

## 基于FIFO资源池的钱龄计算方法及系统

### 独立权利要求

**权利要求1**：一种基于FIFO资源池的钱龄计算方法，其特征在于，包括以下步骤：

S1. 资源入池步骤：采用双端队列数据结构构建FIFO资源池，接收收入事件时创建资源单元，为每个资源单元记录入池时间戳、资金来源、原始金额、剩余金额、资源ID，将资源单元从队列尾部入队，入队操作时间复杂度为O(1)；

S2. 资源消费步骤：采用优先队列算法按先进先出原则处理支出事件，从队列头部获取最早入池的资源单元，从该资源单元扣除支出金额，当资源单元剩余金额为0时从队列头部出队，出队操作时间复杂度为O(1)，FIFO扣除响应时间<100ms；

S3. 钱龄计算步骤：采用增量计算算法实时计算资金年龄，对于每个资源单元计算存活时间=当前时间-入池时间，按剩余金额加权计算平均钱龄=Σ(存活时间×剩余金额)/Σ(剩余金额)，计算响应时间<50ms，钱龄计算准确率>95%；

S4. 状态查询步骤：采用缓存机制预计算资源池状态，包括总剩余金额、资源单元数量、平均钱龄、钱龄分布，当资源池状态变化时更新缓存，查询响应时间<30ms；

S5. 来源追踪步骤：为每个支出记录关联的资源单元列表，记录每个资源单元贡献的金额和来源类型，支持按来源类型统计支出分布，来源识别准确率>95%。

**权利要求2**：一种基于FIFO资源池的钱龄计算系统，其特征在于，包括：

资源池构建模块，配置为采用双端队列数据结构构建FIFO资源池，支持O(1)时间复杂度的入队和出队操作；

资源单元管理模块，配置为记录资源单元属性，包括入池时间戳、资金来源、原始金额、剩余金额、资源ID；

FIFO扣除模块，配置为采用优先队列算法按先进先出原则从资源池中扣除资源，FIFO扣除响应时间<100ms；

钱龄计算模块，配置为采用增量计算算法实时计算资金年龄，计算响应时间<50ms，钱龄计算准确率>95%；

状态查询模块，配置为采用缓存机制预计算资源池状态，查询响应时间<30ms。

### 从属权利要求

**权利要求3**：根据权利要求1所述的方法，其特征在于，所述双端队列数据结构采用Deque实现，支持从队列尾部入队和从队列头部出队，入队和出队操作的时间复杂度均为O(1)。

**权利要求4**：根据权利要求1所述的方法，其特征在于，所述增量计算算法在资源池状态变化时仅计算变化部分，避免全量遍历，计算效率相比全量计算提升>99%。

**权利要求5**：根据权利要求1所述的方法，其特征在于，所述缓存机制预计算的资源池状态包括：总剩余金额、资源单元数量、平均钱龄、0-7天资金占比、7-30天资金占比、30-90天资金占比、90天以上资金占比。

**权利要求6**：根据权利要求1所述的方法，其特征在于，所述资金来源类型包括工资收入、投资收益、转账收入、其他收入，每个资源单元记录其来源类型。

**权利要求7**：根据权利要求1所述的方法，其特征在于，所述来源追踪步骤中，为每个支出记录关联的资源单元列表，每个列表项包括资源单元ID、贡献金额、来源类型、入池时间。

**权利要求8**：根据权利要求2所述的系统，其特征在于，所述资源池构建模块采用双端队列数据结构，所述FIFO扣除模块采用优先队列算法，所述钱龄计算模块采用增量计算算法，所述状态查询模块采用缓存机制。

**权利要求9**：根据权利要求2所述的系统，其特征在于，还包括可视化模块，配置为展示资源池状态、钱龄分布图、资金流向图、来源类型统计图。

**权利要求10**：一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1至7中任一项所述的方法。

**权利要求11**：一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1至7中任一项所述的方法。
