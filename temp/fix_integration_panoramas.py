# -*- coding: utf-8 -*-
"""
批量刷新系统集成全景图
需要刷新的章节: 4, 5, 15, 16, 26
"""

def main():
    filepath = 'd:/code/ai-bookkeeping/docs/design/app_v2_design.md'

    with open(filepath, 'r', encoding='utf-8') as f:
        content = f.read()

    changes = 0

    # ============================================================
    # 修复1: 第4章伙伴化系统集成全景图 - 添加新模块
    # ============================================================
    old_text1 = '''```
┌────────────────────────────────────────────────────────────────────────────┐
│                      伙伴化系统 - 集成架构全景                                │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│                        ┌─────────────────────┐                             │
│                        │   CompanionService   │                             │
│                        │     伙伴化核心服务    │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────┬───────────┼───────────┬─────────────┐              │
│         │             │           │           │             │              │
│         ▼             ▼           ▼           ▼             ▼              │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌──────────┐ │
│  │  钱龄系统   │ │  预算系统   │ │  交易系统   │ │  储蓄目标   │ │ 智能化   │ │
│  │            │ │            │ │            │ │            │ │  系统    │ │
│  │ • 钱龄变化  │ │ • 预算进度  │ │ • 记账事件  │ │ • 目标达成  │ │ • AI洞察 │ │
│  │ • 趋势方向  │ │ • 超支预警  │ │ • 连续记账  │ │ • 存款变化  │ │ • 智能建议│ │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘ └──────────┘ │
│         │             │           │           │             │              │
│         └─────────────┴───────────┼───────────┴─────────────┘              │
│                                   │                                        │
│                        ┌──────────┴──────────┐                             │
│                        │    触发事件总线      │                             │
│                        │  CompanionEventBus   │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────────────────┼─────────────────────────┐              │
│         │                         │                         │              │
│         ▼                         ▼                         ▼              │
│  ┌────────────────┐    ┌────────────────┐    ┌────────────────┐           │
│  │   场景触发器    │    │   文案生成器    │    │   效果追踪器    │           │
│  │                │    │                │    │                │           │
│  │ • 时机判断     │    │ • LLM生成      │    │ • 展示率       │           │
│  │ • 频率控制     │    │ • 模板渲染      │    │ • 互动率       │           │
│  │ • 优先级排序   │    │ • 变体选择      │    │ • 关闭率       │           │
│  └────────────────┘    └────────────────┘    └────────────────┘           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```'''

    new_text1 = '''```
┌────────────────────────────────────────────────────────────────────────────┐
│                      伙伴化系统 - 集成架构全景                                │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│                        ┌─────────────────────┐                             │
│                        │   CompanionService   │                             │
│                        │     伙伴化核心服务    │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────┬───────────┼───────────┬─────────────┐              │
│         │             │           │           │             │              │
│         ▼             ▼           ▼           ▼             ▼              │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌──────────┐ │
│  │  钱龄系统   │ │  预算系统   │ │  交易系统   │ │  储蓄目标   │ │ 智能化   │ │
│  │  (第7章)   │ │  (第8章)   │ │  (第6章)   │ │  (第8章)   │ │ (第10章) │ │
│  │ • 钱龄变化  │ │ • 预算进度  │ │ • 记账事件  │ │ • 目标达成  │ │ • AI洞察 │ │
│  │ • 趋势方向  │ │ • 超支预警  │ │ • 连续记账  │ │ • 存款变化  │ │ • 智能建议│ │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘ └──────────┘ │
│         │             │           │           │             │              │
│         └─────────────┴───────────┼───────────┴─────────────┘              │
│                                   │                                        │
│  ────────────────────────────────────────────────────────────────────────  │
│                           2.0新增协作模块                                    │
│  ────────────────────────────────────────────────────────────────────────  │
│                                                                            │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐        │
│  │家庭账本  │ │语音交互  │ │自学习系统│ │位置智能  │ │用户增长  │        │
│  │ (13章)  │ │ (18章)  │ │ (17章)  │ │ (14章)  │ │(28-29章)│        │
│  │         │ │         │ │         │ │         │ │         │        │
│  │家庭鼓励 │ │语音播报 │ │个性适应 │ │场景提醒 │ │NPS跟进  │        │
│  │协作反馈 │ │情感交互 │ │时机优化 │ │位置触发 │ │分享引导 │        │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘        │
│                                   │                                        │
│                        ┌──────────┴──────────┐                             │
│                        │    触发事件总线      │                             │
│                        │  CompanionEventBus   │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────────────────┼─────────────────────────┐              │
│         │                         │                         │              │
│         ▼                         ▼                         ▼              │
│  ┌────────────────┐    ┌────────────────┐    ┌────────────────┐           │
│  │   场景触发器    │    │   文案生成器    │    │   效果追踪器    │           │
│  │                │    │                │    │                │           │
│  │ • 时机判断     │    │ • LLM生成      │    │ • 展示率       │           │
│  │ • 频率控制     │    │ • 模板渲染      │    │ • 互动率       │           │
│  │ • 优先级排序   │    │ • 变体选择      │    │ • 关闭率       │           │
│  └────────────────┘    └────────────────┘    └────────────────┘           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```'''

    if old_text1 in content:
        content = content.replace(old_text1, new_text1)
        print("✓ 修复1: 第4章伙伴化系统集成全景图添加2.0新增协作模块")
        changes += 1

    # ============================================================
    # 修复2: 第5章无障碍设计集成全景图 - 添加新模块
    # ============================================================
    old_text2 = '''```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                       无障碍设计 - 系统集成全景图                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                          ┌───────────────────────┐                              │
│                          │    无障碍服务中心      │                              │
│                          │ AccessibilityService  │                              │
│                          └───────────┬───────────┘                              │
│    ┌─────────────┬───────────┬───────┴───────┬───────────┬─────────────┐       │
│    ▼             ▼           ▼               ▼           ▼             ▼       │
│ ┌───────┐  ┌───────┐  ┌───────────┐  ┌───────────┐  ┌───────┐  ┌───────────┐  │
│ │语音记账│  │钱龄系统│  │ 预算系统  │  │ 交易系统  │  │报表系统│  │智能化系统 │  │
│ │语音反馈│  │语义描述│  │进度播报   │  │列表语义   │  │图表描述│  │AI语音交互 │  │
│ └───────┘  └───────┘  └───────────┘  └───────────┘  └───────┘  └───────────┘  │
└─────────────────────────────────────────────────────────────────────────────────┘
```'''

    new_text2 = '''```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                       无障碍设计 - 系统集成全景图                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                          ┌───────────────────────┐                              │
│                          │    无障碍服务中心      │                              │
│                          │ AccessibilityService  │                              │
│                          └───────────┬───────────┘                              │
│    ┌─────────────┬───────────┬───────┴───────┬───────────┬─────────────┐       │
│    ▼             ▼           ▼               ▼           ▼             ▼       │
│ ┌───────┐  ┌───────┐  ┌───────────┐  ┌───────────┐  ┌───────┐  ┌───────────┐  │
│ │语音记账│  │钱龄系统│  │ 预算系统  │  │ 交易系统  │  │报表系统│  │智能化系统 │  │
│ │ (18章)│  │ (7章) │  │  (8章)   │  │  (6章)   │  │ (12章)│  │  (10章)  │  │
│ │语音反馈│  │语义描述│  │进度播报   │  │列表语义   │  │图表描述│  │AI语音交互 │  │
│ └───────┘  └───────┘  └───────────┘  └───────────┘  └───────┘  └───────────┘  │
│                                                                                 │
│  ───────────────────────────────────────────────────────────────────────────   │
│                              2.0新增无障碍集成                                   │
│  ───────────────────────────────────────────────────────────────────────────   │
│                                                                                 │
│ ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐     │
│ │ 家庭账本  │  │ 习惯培养  │  │ 位置智能  │  │ 自学习系统 │  │ 伙伴化    │     │
│ │  (13章)  │  │  (9章)   │  │  (14章)  │  │  (17章)  │  │  (4章)   │     │
│ │          │  │          │  │          │  │          │  │          │     │
│ │ 成员语义  │  │ 成就播报  │  │ 位置播报  │  │ 智能适配  │  │ 情感化语音 │     │
│ │ 协作提醒  │  │ 进度描述  │  │ 围栏提醒  │  │ 个性简化  │  │ 鼓励朗读  │     │
│ └───────────┘  └───────────┘  └───────────┘  └───────────┘  └───────────┘     │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```'''

    if old_text2 in content:
        content = content.replace(old_text2, new_text2)
        print("✓ 修复2: 第5章无障碍设计集成全景图添加2.0新增无障碍集成")
        changes += 1

    # ============================================================
    # 修复3: 第15章技术架构集成全景图 - 添加新模块
    # ============================================================
    old_text3 = '''```
┌────────────────────────────────────────────────────────────────────────────┐
│                      技术架构 - 系统集成全景                                  │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│                        ┌─────────────────────┐                             │
│                        │     技术基础设施      │                             │
│                        │   Infrastructure     │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────┬───────────┼───────────┬─────────────┐              │
│         │             │           │           │             │              │
│         ▼             ▼           ▼           ▼             ▼              │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌──────────┐ │
│  │  钱龄系统   │ │  预算系统   │ │  同步系统   │ │  报表系统   │ │ AI系统   │ │
│  │            │ │            │ │            │ │            │ │          │ │
│  │ 资源池存储  │ │ 小金库存储  │ │ 队列处理   │ │ 聚合计算   │ │ API调用  │ │
│  │ FIFO算法   │ │ 周期调度   │ │ 冲突解决   │ │ 缓存策略   │ │ 模型推理 │ │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘ └──────────┘ │
│         │             │           │           │             │              │
│         └─────────────┴───────────┼───────────┴─────────────┘              │
│                                   │                                        │
│                        ┌──────────┴──────────┐                             │
│                        │    核心技术服务      │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────────────────┼─────────────────────────┐              │
│         │                         │                         │              │
│         ▼                         ▼                         ▼              │
│  ┌────────────────┐    ┌────────────────┐    ┌────────────────┐           │
│  │    数据层       │    │    安全层       │    │    监控层       │           │
│  │                │    │                │    │                │           │
│  │ • 本地数据库   │    │ • 加密服务     │    │ • 日志收集     │           │
│  │ • 远程数据库   │    │ • 认证授权     │    │ • 指标采集     │           │
│  │ • 缓存系统     │    │ • 隐私保护     │    │ • 链路追踪     │           │
│  └────────────────┘    └────────────────┘    └────────────────┘           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```'''

    new_text3 = '''```
┌────────────────────────────────────────────────────────────────────────────┐
│                      技术架构 - 系统集成全景                                  │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│                        ┌─────────────────────┐                             │
│                        │     技术基础设施      │                             │
│                        │   Infrastructure     │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────┬───────────┼───────────┬─────────────┐              │
│         │             │           │           │             │              │
│         ▼             ▼           ▼           ▼             ▼              │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌──────────┐ │
│  │  钱龄系统   │ │  预算系统   │ │  同步系统   │ │  报表系统   │ │ AI系统   │ │
│  │  (第7章)   │ │  (第8章)   │ │  (第16章)  │ │  (第12章)  │ │ (第10章) │ │
│  │ 资源池存储  │ │ 小金库存储  │ │ 队列处理   │ │ 聚合计算   │ │ API调用  │ │
│  │ FIFO算法   │ │ 周期调度   │ │ 冲突解决   │ │ 缓存策略   │ │ 模型推理 │ │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘ └──────────┘ │
│                                                                            │
│  ────────────────────────────────────────────────────────────────────────  │
│                              2.0新增技术支撑                                 │
│  ────────────────────────────────────────────────────────────────────────  │
│                                                                            │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐        │
│  │家庭账本  │ │语音交互  │ │自学习系统│ │位置智能  │ │导入导出  │        │
│  │ (13章)  │ │ (18章)  │ │ (17章)  │ │ (14章)  │ │ (11章)  │        │
│  │         │ │         │ │         │ │         │ │         │        │
│  │协作锁   │ │语音流   │ │模型存储 │ │地理索引 │ │批量处理 │        │
│  │权限控制 │ │TTS服务  │ │增量学习 │ │围栏计算 │ │大文件流 │        │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘        │
│         │             │           │           │             │              │
│         └─────────────┴───────────┼───────────┴─────────────┘              │
│                                   │                                        │
│                        ┌──────────┴──────────┐                             │
│                        │    核心技术服务      │                             │
│                        └──────────┬──────────┘                             │
│                                   │                                        │
│         ┌─────────────────────────┼─────────────────────────┐              │
│         │                         │                         │              │
│         ▼                         ▼                         ▼              │
│  ┌────────────────┐    ┌────────────────┐    ┌────────────────┐           │
│  │    数据层       │    │    安全层       │    │    监控层       │           │
│  │                │    │                │    │                │           │
│  │ • 本地数据库   │    │ • 加密服务     │    │ • 日志收集     │           │
│  │ • 远程数据库   │    │ • 认证授权     │    │ • 指标采集     │           │
│  │ • 缓存系统     │    │ • 隐私保护     │    │ • 链路追踪     │           │
│  └────────────────┘    └────────────────┘    └────────────────┘           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```'''

    if old_text3 in content:
        content = content.replace(old_text3, new_text3)
        print("✓ 修复3: 第15章技术架构集成全景图添加2.0新增技术支撑")
        changes += 1

    # ============================================================
    # 修复4: 第16章智能化技术集成全景图 - 添加新模块
    # ============================================================
    old_text4 = '''```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                     智能化技术方案 - 系统集成全景图                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│                          ┌───────────────────────┐                              │
│                          │   智能化技术方案       │                              │
│                          │  SmartAIService       │                              │
│                          └───────────┬───────────┘                              │
│                                      │                                          │
│    ┌─────────────┬───────────┬───────┴───────┬───────────┬─────────────┐       │
│    │             │           │               │           │             │       │
│    ▼             ▼           ▼               ▼           ▼             ▼       │
│ ┌───────┐  ┌───────┐  ┌───────────┐  ┌───────────┐  ┌───────┐  ┌───────────┐  │
│ │交易系统│  │预算系统│  │零基预算   │  │ 钱龄系统  │  │习惯培养│  │数据导入   │  │
│ │       │  │       │  │           │  │           │  │       │  │           │  │
│ │智能分类│  │预算建议│  │智能分配   │  │趋势预测   │  │行为预测│  │智能解析   │  │
│ │异常检测│  │超支预警│  │优化建议   │  │结构洞察   │  │时机推荐│  │分类建议   │  │
│ │语音记账│  │周期分析│  │场景识别   │  │异常检测   │  │鼓励生成│  │去重识别   │  │
│ └───┬───┘  └───┬───┘  └─────┬─────┘  └─────┬─────┘  └───┬───┘  └─────┬─────┘  │
│     │          │            │              │            │            │         │
│     └──────────┴────────────┴──────────────┴────────────┴────────────┘         │
│                                      │                                          │
│                                      ▼                                          │
│              ┌─────────────────────────────────────────────┐                   │
│              │             反馈学习引擎                      │                   │
│              │  用户修正 → 规则沉淀 → 精度提升 → 成本降低   │                   │
│              └─────────────────────────────────────────────┘                   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```'''

    new_text4 = '''```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                     智能化技术方案 - 系统集成全景图                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│                          ┌───────────────────────┐                              │
│                          │   智能化技术方案       │                              │
│                          │  SmartAIService       │                              │
│                          └───────────┬───────────┘                              │
│                                      │                                          │
│    ┌─────────────┬───────────┬───────┴───────┬───────────┬─────────────┐       │
│    │             │           │               │           │             │       │
│    ▼             ▼           ▼               ▼           ▼             ▼       │
│ ┌───────┐  ┌───────┐  ┌───────────┐  ┌───────────┐  ┌───────┐  ┌───────────┐  │
│ │交易系统│  │预算系统│  │零基预算   │  │ 钱龄系统  │  │习惯培养│  │数据导入   │  │
│ │ (6章) │  │ (8章) │  │  (8章)   │  │  (7章)   │  │ (9章) │  │  (11章)  │  │
│ │智能分类│  │预算建议│  │智能分配   │  │趋势预测   │  │行为预测│  │智能解析   │  │
│ │异常检测│  │超支预警│  │优化建议   │  │结构洞察   │  │时机推荐│  │分类建议   │  │
│ │语音记账│  │周期分析│  │场景识别   │  │异常检测   │  │鼓励生成│  │去重识别   │  │
│ └───────┘  └───────┘  └───────────┘  └───────────┘  └───────┘  └───────────┘  │
│                                                                                 │
│  ───────────────────────────────────────────────────────────────────────────   │
│                              2.0新增AI集成                                       │
│  ───────────────────────────────────────────────────────────────────────────   │
│                                                                                 │
│ ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐     │
│ │ 家庭账本  │  │ 语音交互  │  │ 自学习系统 │  │ 位置智能  │  │ 伙伴化    │     │
│ │  (13章)  │  │  (18章)  │  │  (17章)  │  │  (14章)  │  │  (4章)   │     │
│ │          │  │          │  │          │  │          │  │          │     │
│ │ 家庭消费  │  │ 意图理解  │  │ 个性化模型 │  │ 场景识别  │  │ 情感分析  │     │
│ │ 模式分析  │  │ 多轮对话  │  │ 协同学习  │  │ POI分类  │  │ 文案生成  │     │
│ └───────────┘  └───────────┘  └───────────┘  └───────────┘  └───────────┘     │
│                                      │                                          │
│                                      ▼                                          │
│              ┌─────────────────────────────────────────────┐                   │
│              │             反馈学习引擎                      │                   │
│              │  用户修正 → 规则沉淀 → 精度提升 → 成本降低   │                   │
│              └─────────────────────────────────────────────┘                   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```'''

    if old_text4 in content:
        content = content.replace(old_text4, new_text4)
        print("✓ 修复4: 第16章智能化技术集成全景图添加2.0新增AI集成")
        changes += 1

    # ============================================================
    # 修复5: 第26章版本迁移集成全景图 - 添加新模块
    # ============================================================
    old_text5 = '''```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                      版本迁移策略 - 系统集成全景图                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│                          ┌───────────────────────┐                              │
│                          │    版本迁移服务        │                              │
│                          │  MigrationService     │                              │
│                          └───────────┬───────────┘                              │
│                                      │                                          │
│    ┌─────────────┬───────────┬───────┴───────┬───────────┬─────────────┐       │
│    │             │           │               │           │             │       │
│    ▼             ▼           ▼               ▼           ▼             ▼       │
│ ┌───────┐  ┌───────┐  ┌───────────┐  ┌───────────┐  ┌───────┐  ┌───────────┐  │
│ │钱龄系统│  │零基预算│  │ 数据导入  │  │ 数据备份  │  │APP升级│  │同步系统   │  │
│ │       │  │       │  │           │  │           │  │       │  │           │  │
│ │资源池  │  │小金库  │  │格式转换   │  │升级备份   │  │版本元数│  │数据对齐   │  │
│ │初始化  │  │迁移    │  │兼容性处理 │  │完整恢复   │  │据检查  │  │版本同步   │  │
│ └───────┘  └───────┘  └───────────┘  └───────────┘  └───────┘  └───────────┘  │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```'''

    new_text5 = '''```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                      版本迁移策略 - 系统集成全景图                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│                          ┌───────────────────────┐                              │
│                          │    版本迁移服务        │                              │
│                          │  MigrationService     │                              │
│                          └───────────┬───────────┘                              │
│                                      │                                          │
│    ┌─────────────┬───────────┬───────┴───────┬───────────┬─────────────┐       │
│    │             │           │               │           │             │       │
│    ▼             ▼           ▼               ▼           ▼             ▼       │
│ ┌───────┐  ┌───────┐  ┌───────────┐  ┌───────────┐  ┌───────┐  ┌───────────┐  │
│ │钱龄系统│  │零基预算│  │ 数据导入  │  │ 数据备份  │  │APP升级│  │同步系统   │  │
│ │ (7章) │  │ (8章) │  │  (11章)  │  │  (本章)  │  │(本章) │  │  (16章)  │  │
│ │资源池  │  │小金库  │  │格式转换   │  │升级备份   │  │版本元数│  │数据对齐   │  │
│ │初始化  │  │迁移    │  │兼容性处理 │  │完整恢复   │  │据检查  │  │版本同步   │  │
│ └───────┘  └───────┘  └───────────┘  └───────────┘  └───────┘  └───────────┘  │
│                                                                                 │
│  ───────────────────────────────────────────────────────────────────────────   │
│                              2.0新增迁移模块                                     │
│  ───────────────────────────────────────────────────────────────────────────   │
│                                                                                 │
│ ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐     │
│ │ 家庭账本  │  │ 语音交互  │  │ 自学习系统 │  │ 位置智能  │  │ 习惯培养  │     │
│ │  (13章)  │  │  (18章)  │  │  (17章)  │  │  (14章)  │  │  (9章)   │     │
│ │          │  │          │  │          │  │          │  │          │     │
│ │ 家庭关系  │  │ 语音配置  │  │ 学习模型  │  │ 位置偏好  │  │ 成就数据  │     │
│ │ 表迁移   │  │ 数据迁移  │  │ 数据迁移  │  │ 数据迁移  │  │ 积分迁移  │     │
│ └───────────┘  └───────────┘  └───────────┘  └───────────┘  └───────────┘     │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```'''

    if old_text5 in content:
        content = content.replace(old_text5, new_text5)
        print("✓ 修复5: 第26章版本迁移集成全景图添加2.0新增迁移模块")
        changes += 1

    if changes > 0:
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        print(f"\n===== 系统集成全景图批量刷新完成，共 {changes} 处 =====")
    else:
        print("\n未找到目标位置或已刷新")

    return changes

if __name__ == '__main__':
    main()
