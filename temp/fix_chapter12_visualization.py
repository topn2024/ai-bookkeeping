# -*- coding: utf-8 -*-
"""
刷新第12章12.2可视化组件体系
1. 扩展组件分类图添加2.0新增组件
2. 添加设计规范的2.0扩展
"""

def main():
    filepath = 'd:/code/ai-bookkeeping/docs/design/app_v2_design.md'

    with open(filepath, 'r', encoding='utf-8') as f:
        content = f.read()

    changes = 0

    # ============================================================
    # 修复1: 扩展可视化组件体系图 - 添加2.0新增组件
    # ============================================================
    old_text1 = '''#### 12.2.1 组件分类与设计规范

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          可视化组件体系                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                         图表组件 (Charts)                            │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 饼图/   │ │ 柱状图  │ │ 折线图  │ │ 热力图  │ │ 漏斗图  │       │   │
│   │  │ 环形图  │ │ 堆叠图  │ │ 面积图  │ │ 日历图  │ │ 雷达图  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                         卡片组件 (Cards)                             │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 数值卡片│ │ 进度卡片│ │ 对比卡片│ │ 趋势卡片│ │ 洞察卡片│       │   │
│   │  │ 单指标  │ │ 环形进度│ │ 同期对比│ │ 迷你图  │ │ AI建议  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                         指标组件 (Metrics)                           │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 大数值  │ │ 百分比  │ │ 进度条  │ │ 等级徽章│ │ 趋势箭头│       │   │
│   │  │ 主指标  │ │ 变化率  │ │ 横向/圆形│ │ 颜色分级│ │ 涨跌幅  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   设计规范：                                                                │
│   • 所有组件必须支持点击事件和触觉反馈                                      │
│   • 可点击区域需有视觉提示（颜色变化/图标/下划线）                          │
│   • 图表需支持手势操作（缩放/拖动/长按详情）                                │
│   • 组件需响应深色模式                                                     │
│   • 加载状态需有骨架屏占位                                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```'''

    new_text1 = '''#### 12.2.1 组件分类与设计规范

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          可视化组件体系                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                         图表组件 (Charts)                            │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 饼图/   │ │ 柱状图  │ │ 折线图  │ │ 热力图  │ │ 漏斗图  │       │   │
│   │  │ 环形图  │ │ 堆叠图  │ │ 面积图  │ │ 日历图  │ │ 雷达图  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                         卡片组件 (Cards)                             │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 数值卡片│ │ 进度卡片│ │ 对比卡片│ │ 趋势卡片│ │ 洞察卡片│       │   │
│   │  │ 单指标  │ │ 环形进度│ │ 同期对比│ │ 迷你图  │ │ AI建议  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                         指标组件 (Metrics)                           │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 大数值  │ │ 百分比  │ │ 进度条  │ │ 等级徽章│ │ 趋势箭头│       │   │
│   │  │ 主指标  │ │ 变化率  │ │ 横向/圆形│ │ 颜色分级│ │ 涨跌幅  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ────────────────────────────────────────────────────────────────────────  │
│                          2.0新增组件类型                                     │
│  ────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                    家庭可视化组件 (Family·第13章)                     │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 成员头像│ │ 成员对比│ │ 贡献占比│ │ 协作时间│ │ 家庭排行│       │   │
│   │  │ 消费卡片│ │ 柱状图  │ │ 环形图  │ │ 线图    │ │ 榜单   │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                    位置可视化组件 (Location·第14章)                   │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 地理热力│ │ 商圈分布│ │ 轨迹地图│ │ 位置标记│ │ 区域统计│       │   │
│   │  │ 地图    │ │ 气泡图  │ │ 路径图  │ │ 聚合图  │ │ 柱状图  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                    习惯可视化组件 (Habit·第9章)                       │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 打卡日历│ │ 连续天数│ │ 成就勋章│ │ 习惯雷达│ │ 财务健康│       │   │
│   │  │ 热力图  │ │ 计数器  │ │ 徽章墙  │ │ 多维图  │ │ 分数环  │       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                    语音可视化组件 (Voice·第18章)                      │   │
│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│   │  │ 波形图  │ │ 识别结果│ │ 置信度  │ │ 历史记录│ │ 快捷入口│       │   │
│   │  │ 录音状态│ │ 实时展示│ │ 进度条  │ │ 时间线  │ │ 浮动按钮│       │   │
│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   设计规范：                                                                │
│   • 所有组件必须支持点击事件和触觉反馈                                      │
│   • 可点击区域需有视觉提示（颜色变化/图标/下划线）                          │
│   • 图表需支持手势操作（缩放/拖动/长按详情）                                │
│   • 组件需响应深色模式                                                     │
│   • 加载状态需有骨架屏占位                                                 │
│                                                                             │
│   2.0新增规范：                                                             │
│   • 所有组件需支持语音播报（无障碍·第5章）                                  │
│   • 家庭组件需支持成员权限控制（第13章）                                    │
│   • 位置组件需支持隐私模式（第22章）                                        │
│   • 语音组件需支持实时反馈动画                                              │
│   • 习惯组件需支持动态激励效果（伙伴化·第4章）                              │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

**2.0新增组件详细说明**：

| 组件类别 | 典型组件 | 数据来源 | 下钻支持 |
|---------|---------|---------|---------|
| **家庭可视化** | 成员消费对比柱状图 | 第13章家庭账本 | 点击成员→成员详情页 |
| **位置可视化** | 消费地理热力图 | 第14章位置智能 | 点击区域→区域消费列表 |
| **习惯可视化** | 记账打卡日历 | 第9章习惯培养 | 点击日期→当日记账详情 |
| **语音可视化** | 语音识别波形图 | 第18章语音交互 | 点击记录→识别结果详情 |'''

    if old_text1 in content:
        content = content.replace(old_text1, new_text1)
        print("✓ 修复1: 扩展可视化组件体系图（添加家庭、位置、习惯、语音组件）")
        changes += 1

    if changes > 0:
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        print(f"\n===== 第12章12.2可视化组件体系刷新完成，共 {changes} 处 =====")
    else:
        print("\n未找到目标位置或已刷新")

    return changes

if __name__ == '__main__':
    main()
