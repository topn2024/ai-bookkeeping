# -*- coding: utf-8 -*-
"""
更新智能语音交互系统设计文档
同步原型文件的页面结构变化
"""

# 新的页面清单统计部分
PAGE_STATS_SECTION = '''#### 15.12.0.4 原型页面清单与语音导航适配性分析

基于2.0版本完整高保真原型（119页面），按功能模块分类并分析语音导航适配性。

##### 原型页面统计

| 模块 | 页面数量 | 主要功能 |
|-----|---------|---------|
| 核心页面 | 5个 | 仪表盘、趋势、快速记账、预算、个人中心 |
| 钱龄分析 | 8个 | 钱龄详情、趋势、影响因素、FIFO资源池等 |
| 小金库 | 9个 | 概览、详情、资金分配、创建、零基预算等 |
| 账户交易 | 5个 | 账户列表、交易列表、交易详情、债务管理等 |
| 导入导出 | 15个 | 导入账单、去重检测、格式检测、字段映射等 |
| 语音识别 | 12个 | 语音记账、图片OCR、对话历史、AA分摊等 |
| 分析报告 | 10个 | 月报、年报、洞察、饼图下钻、热力图等 |
| 系统设置 | 25个 | 设置、主题、语言、货币、位置、安全等 |
| 数据联动 | 5个 | 分类详情、搜索、高级筛选、时间对比等 |
| 习惯培养 | 7个 | 财务健康、订阅浪费、拿铁因子、应急金等 |
| 异常处理 | 6个 | 网络错误、同步冲突、完整性检查等 |
| 系统监控 | 6个 | 性能监控、系统日志、告警历史、AI监控等 |
| 账单提醒 | 6个 | 账单列表、添加账单、信用卡提醒、日历等 |
| AI智能中心 | 10个 | 智能分类、趋势预测、异常检测、对话助手等 |
| **合计** | **119个** | |

---

##### 一、核心页面（5个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 1.01 | 仪表盘 Dashboard | ✅ 高 | 高频入口，表达简单 | "打开首页"、"回到主页" |
| 1.02 | 趋势分析 Trends | ✅ 高 | 常用功能 | "看看趋势"、"打开趋势分析" |
| 1.03 | 快速记账 Quick Add | ✅ 高 | 核心功能 | "记一笔"、"快速记账" |
| 1.04 | 预算中心 Budget | ✅ 高 | 常用功能 | "打开预算"、"看看预算" |
| 1.05 | 个人中心 Profile | ✅ 高 | 常用入口 | "打开我的"、"个人中心" |

**小结：5/5 高适配（100%）**

---

##### 二、钱龄分析（8个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 2.01 | 钱龄详情 | ✅ 高 | 核心2.0功能 | "看看钱龄"、"打开钱龄" |
| 2.02 | 钱龄升级引导 | ⚠️ 中 | 引导页，偶尔使用 | "怎么提升钱龄" |
| 2.03 | 钱龄历史趋势 | ✅ 高 | 数据查看 | "钱龄趋势"、"钱龄历史" |
| 2.04 | 影响因素分析 | ⚠️ 中 | 分析页面 | "什么影响了钱龄" |
| 2.05 | 钱龄阶段进度 | ⚠️ 中 | 详情页 | "钱龄进度" |
| 2.06 | 单笔交易钱龄 | ❌ 低 | 需先选择交易 | 语音打开交易详情后手动查看 |
| 2.07 | FIFO资源池 | ❌ 低 | 专业页面，不常用 | 保持图形界面 |
| 2.08 | 钱龄预算联动 | ⚠️ 中 | 关联页面 | "钱龄和预算关系" |

**小结：2高/4中/2低**

---

##### 三、小金库（9个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 3.01 | 小金库概览 | ✅ 高 | 核心功能入口 | "打开小金库"、"看看小金库" |
| 3.02 | 小金库详情 | ✅ 高 | 常用查看 | "XX小金库详情" |
| 3.03 | 资金分配 | ⚠️ 中 | 需要操作 | "分配资金" |
| 3.04 | 创建小金库 | ⚠️ 中 | 多轮对话 | "创建一个旅游小金库" |
| 3.05 | 智能分配建议 | ✅ 高 | 建议查看 | "智能分配建议" |
| 3.06 | 状态警告 | ⚠️ 中 | 系统触发为主 | "小金库有什么警告" |
| 3.07 | 预算钱龄联动 | ⚠️ 中 | 关联页面 | "预算和钱龄联动" |
| 3.08 | 消费拦截 | ❌ 低 | 系统弹窗，非主动打开 | 系统自动触发 |
| 3.09 | 零基预算分配 | ⚠️ 中 | 预算工具 | "零基预算" |

**小结：3高/5中/1低**

---

##### 四、账户交易（5个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 4.01 | 账户列表 | ✅ 高 | 常用查看 | "打开账户"、"看看账户" |
| 4.02 | 交易列表 | ✅ 高 | 核心查看 | "看看账单"、"交易记录" |
| 4.03 | 交易详情 | ⚠️ 中 | 需先选择交易 | "刚才那笔详情" |
| 4.04 | 手动记账详情 | ✅ 高 | 核心功能 | "手动记账" |
| 4.05 | 债务管理 | ✅ 高 | 常用功能 | "债务管理"、"看看欠款" |

**小结：4高/1中**

---

##### 五、导入导出（15个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 5.01 | 导入账单 | ⚠️ 中 | 需文件选择 | "导入账单" |
| 5.02 | 去重检测 | ❌ 低 | 流程中间页 | 导入流程自动进入 |
| 5.03 | 交易对比 | ❌ 低 | 需选择交易 | 去重流程中使用 |
| 5.04 | 导出账单 | ⚠️ 中 | 常用功能 | "导出账单"、"导出本月数据" |
| 5.05 | PDF导出预览 | ❌ 低 | 导出流程页 | 导出时自动进入 |
| 5.06 | 银行账单导入 | ⚠️ 中 | 需文件操作 | "导入银行账单" |
| 5.07 | 批量编辑 | ❌ 低 | 需多选操作 | 保持图形界面 |
| 5.08 | 导入历史 | ⚠️ 中 | 查看记录 | "导入历史" |
| 5.09 | 智能格式检测 | ❌ 低 | 流程自动页 | 导入时自动进入 |
| 5.10 | 字段映射配置 | ❌ 低 | 复杂配置 | 保持图形界面 |
| 5.11 | 三层去重详情 | ❌ 低 | 技术详情页 | 保持图形界面 |
| 5.12 | 导入预览确认 | ❌ 低 | 流程确认页 | 导入时自动进入 |
| 5.13 | 导入进度 | ❌ 低 | 进度展示 | 系统自动展示 |
| 5.14 | 导出高级配置 | ❌ 低 | 复杂配置 | 保持图形界面 |
| 5.15 | 导入成功 | ❌ 低 | 结果页 | 系统自动展示 |

**小结：0高/4中/11低**

---

##### 六、语音识别（12个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 6.01 | 准备录音 | ✅ 高 | 核心功能 | "语音记账" |
| 6.02 | 录音中 | ✅ 高 | 语音触发 | 自然语音输入 |
| 6.03 | 识别结果 | ✅ 高 | 语音确认 | "确认"、"取消" |
| 6.04 | 多条交易识别 | ✅ 高 | 批量确认 | "都记上" |
| 6.05 | 图片OCR识别 | ✅ 高 | 核心功能 | "拍照记账" |
| 6.06 | 对话历史 | ⚠️ 中 | 查看记录 | "对话历史" |
| 6.07 | 小票商品明细 | ❌ 低 | 识别详情 | 识别后自动展示 |
| 6.08 | 支付截图识别 | ✅ 高 | 核心功能 | "识别截图" |
| 6.09 | AA制分摊确认 | ⚠️ 中 | 需选择成员 | "AA分摊" |
| 6.10 | 低置信度确认 | ⚠️ 中 | 系统触发 | 语音"确认"或"修改" |
| 6.11 | 离线模式提示 | ❌ 低 | 系统提示 | 系统自动展示 |
| 6.12 | 连续对话记账 | ✅ 高 | 核心功能 | 连续语音输入 |

**小结：7高/3中/2低**

---

##### 七、分析报告（10个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 7.01 | 月度报告 | ✅ 高 | 常用查看 | "月度报告"、"本月报告" |
| 7.02 | 洞察分析 | ✅ 高 | 常用功能 | "消费洞察"、"分析" |
| 7.03 | 年度总结 | ✅ 高 | 常用查看 | "年度报告"、"年度总结" |
| 7.04 | 预算报告 | ✅ 高 | 常用查看 | "预算报告" |
| 7.05 | 分类饼图下钻 | ⚠️ 中 | 点击触发 | "餐饮花了多少" |
| 7.06 | 趋势图下钻 | ⚠️ 中 | 点击触发 | "上月对比" |
| 7.07 | 消费热力图 | ⚠️ 中 | 查看分析 | "消费热力图" |
| 7.08 | 下钻导航 | ❌ 低 | 导航中间页 | 点击触发 |
| 7.09 | 数据筛选 | ⚠️ 中 | 需多选 | "筛选餐饮" |
| 7.10 | 图表分享 | ⚠️ 中 | 需选择方式 | "分享报告" |

**小结：4高/5中/1低**

---

##### 八、系统设置（25个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 8.01 | 系统设置 | ✅ 高 | 入口页面 | "打开设置" |
| 8.02 | 主题设置 | ✅ 高 | 常用设置 | "主题设置"、"换主题" |
| 8.03 | 语言设置 | ✅ 高 | 常用设置 | "语言设置"、"换语言" |
| 8.04 | 货币设置 | ✅ 高 | 常用设置 | "货币设置" |
| 8.05 | 区域设置 | ⚠️ 中 | 偶尔使用 | "区域设置" |
| 8.06 | AI语言设置 | ⚠️ 中 | 偶尔使用 | "AI语言设置" |
| 8.07 | 通知设置 | ✅ 高 | 常用设置 | "通知设置" |
| 8.08 | 数据同步 | ✅ 高 | 常用功能 | "同步设置"、"数据同步" |
| 8.09 | 分类管理 | ✅ 高 | 常用管理 | "分类管理" |
| 8.10 | 账户管理 | ✅ 高 | 常用管理 | "账户管理" |
| 8.11 | 会员服务 | ⚠️ 中 | 偶尔查看 | "会员服务"、"升级会员" |
| 8.12 | 关于应用 | ⚠️ 中 | 偶尔查看 | "关于"、"版本" |
| 8.13 | 安全设置 | ✅ 高 | 入口页面 | "安全设置" |
| 8.14 | 位置服务设置 | ⚠️ 中 | 隐私敏感 | "位置设置" |
| 8.15 | 常驻地点设置 | ❌ 低 | 需地图操作 | 保持图形界面 |
| 8.16 | 地理围栏管理 | ❌ 低 | 需地图操作 | 保持图形界面 |
| 8.17 | 位置分析报告 | ⚠️ 中 | 查看分析 | "位置分析" |
| 8.18 | 异地消费记录 | ⚠️ 中 | 查看记录 | "异地消费" |
| 8.19 | 位置省钱建议 | ⚠️ 中 | 查看建议 | "省钱建议" |
| 8.20 | 应用锁设置 | ⚠️ 中 | 安全设置 | "应用锁设置" |
| 8.21 | PIN码设置 | ❌ 低 | 需键盘输入 | 语音打开后手动输入 |
| 8.22 | 隐私模式设置 | ✅ 高 | 开关操作 | "隐私模式设置" |
| 8.23 | 备份管理 | ✅ 高 | 常用功能 | "备份管理" |
| 8.24 | 安全审计日志 | ⚠️ 中 | 查看日志 | "安全日志" |
| 8.25 | 数据管理 | ✅ 高 | 常用功能 | "数据管理" |

**小结：12高/10中/3低**

---

##### 九、数据联动（5个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 9.01 | 分类详情 | ⚠️ 中 | 需指定分类 | "餐饮详情" |
| 9.02 | 搜索结果 | ✅ 高 | 搜索功能 | "搜索XX" |
| 9.03 | 高级筛选 | ⚠️ 中 | 多条件组合 | "筛选" |
| 9.04 | 时间对比 | ⚠️ 中 | 需选时间 | "本月和上月对比" |
| 9.05 | 标签筛选 | ⚠️ 中 | 需选标签 | "按标签筛选" |

**小结：1高/4中**

---

##### 十、习惯培养（7个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 10.01 | 财务健康仪表盘 | ✅ 高 | 核心功能 | "财务健康"、"健康度" |
| 10.02 | 订阅浪费识别 | ✅ 高 | 查看分析 | "订阅分析"、"有什么浪费" |
| 10.03 | 拿铁因子分析 | ✅ 高 | 查看分析 | "拿铁因子"、"小额消费" |
| 10.04 | 冲动消费确认 | ❌ 低 | 系统弹窗 | 系统自动触发 |
| 10.05 | 应急金目标 | ✅ 高 | 目标查看 | "应急金"、"应急金进度" |
| 10.06 | 钱龄进阶 | ⚠️ 中 | 引导页 | "怎么提升钱龄" |
| 10.07 | 连续打卡 | ✅ 高 | 常用功能 | "打卡"、"看看打卡" |

**小结：5高/1中/1低**

---

##### 十一、异常处理（6个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 11.01 | 网络错误页面 | ❌ 低 | 系统触发 | 系统自动展示 |
| 11.02 | 同步冲突解决 | ❌ 低 | 需选择操作 | 建议图形界面 |
| 11.03 | 数据完整性检查 | ⚠️ 中 | 查看状态 | "数据检查" |
| 11.04 | 离线操作队列 | ⚠️ 中 | 查看队列 | "离线队列" |
| 11.05 | 错误对话框 | ❌ 低 | 系统弹窗 | 系统自动触发 |
| 11.06 | 重试状态提示 | ❌ 低 | 系统提示 | 系统自动展示 |

**小结：0高/2中/4低**

---

##### 十二、系统监控（6个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 12.01 | 应用健康状态 | ⚠️ 中 | 查看状态 | "应用状态" |
| 12.02 | 性能监控 | ⚠️ 中 | 技术页面 | "性能监控" |
| 12.03 | 系统日志 | ❌ 低 | 技术页面 | 保持图形界面 |
| 12.04 | 告警历史 | ⚠️ 中 | 查看记录 | "告警历史" |
| 12.05 | AI服务监控 | ⚠️ 中 | 技术页面 | "AI状态" |
| 12.06 | 诊断报告 | ⚠️ 中 | 查看报告 | "诊断报告" |

**小结：0高/5中/1低**

---

##### 十三、账单提醒（6个）

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 13.01 | 账单提醒列表 | ✅ 高 | 常用入口 | "账单提醒"、"定期账单" |
| 13.02 | 添加定期账单 | ⚠️ 中 | 多轮对话 | "添加账单提醒" |
| 13.03 | 信用卡还款提醒 | ✅ 高 | 常用查看 | "信用卡提醒" |
| 13.04 | 到期通知详情 | ⚠️ 中 | 系统推送 | "账单详情" |
| 13.05 | 智能账单建议 | ✅ 高 | 建议查看 | "账单建议" |
| 13.06 | 账单日历视图 | ⚠️ 中 | 可视化 | "账单日历" |

**小结：3高/3中**

---

##### 十四、AI智能中心（10个）【新增】

| 序号 | 页面名称 | 语音适配 | 适配理由 | 语音指令示例 |
|-----|---------|---------|---------|-------------|
| 14.01 | 智能分类中心 | ✅ 高 | AI核心功能 | "智能分类"、"分类设置" |
| 14.02 | 分类反馈学习 | ⚠️ 中 | 查看学习状态 | "分类学习记录" |
| 14.03 | 消费趋势预测 | ✅ 高 | AI预测功能 | "预测消费"、"消费预测" |
| 14.04 | 异常检测设置 | ⚠️ 中 | 配置页面 | "异常检测设置" |
| 14.05 | 异常交易详情 | ⚠️ 中 | 查看详情 | "异常交易" |
| 14.06 | 自然语言搜索 | ✅ 高 | AI核心功能 | "智能搜索"、"搜索XX" |
| 14.07 | 对话助手设置 | ⚠️ 中 | 配置页面 | "对话助手设置" |
| 14.08 | 语音配置中心 | ✅ 高 | 语音核心 | "语音设置"、"语音配置" |
| 14.09 | AI成本监控 | ⚠️ 中 | 技术监控 | "AI成本" |
| 14.10 | 智能学习报告 | ✅ 高 | 学习效果 | "学习报告"、"AI学习效果" |

**小结：5高/5中**

---

##### 语音适配总结

| 适配等级 | 页面数量 | 占比 | 说明 |
|---------|---------|-----|------|
| ✅ 高适配 | 51个 | 43% | 语音可直接完成，优先实现 |
| ⚠️ 中适配 | 43个 | 36% | 需配合GUI或多轮对话 |
| ❌ 低适配 | 25个 | 21% | 保持图形界面为主 |

**实施建议：**
1. **第一阶段**：实现51个高适配页面的语音导航
2. **第二阶段**：优化43个中适配页面，增加语音辅助
3. **第三阶段**：为低适配页面提供语音快捷入口

'''

def main():
    filepath = 'd:/code/ai-bookkeeping/docs/design/app_v2_design.md'

    with open(filepath, 'r', encoding='utf-8') as f:
        content = f.read()

    # 找到旧的页面清单部分的起始和结束位置
    start_marker = '#### 15.12.0.4 原型页面清单与语音导航适配性分析'
    end_marker = '#### 15.12.1 意图识别引擎'

    start_idx = content.find(start_marker)
    end_idx = content.find(end_marker)

    if start_idx == -1 or end_idx == -1:
        print(f"找不到标记: start={start_idx}, end={end_idx}")
        return

    # 替换内容
    new_content = content[:start_idx] + PAGE_STATS_SECTION + '\n' + content[end_idx:]

    with open(filepath, 'w', encoding='utf-8') as f:
        f.write(new_content)

    print("页面清单更新完成！")

if __name__ == '__main__':
    main()
