# 自适应模式系统 - 实施任务清单

> **变更ID**: design-adaptive-mode-system
> **日期**: 2026-01-10

## 阶段1：前端原型设计 (P0)

### 1.1 傻瓜模式扩展页面原型

- [ ] **T1.1.1** 设计账单列表页原型
  - 日期分组展示
  - 大字号账单卡片
  - 滑动删除交互
  - 二次确认弹窗

- [ ] **T1.1.2** 设计收入记账页原型
  - 复用金额输入组件
  - 收入分类选择（5个：工资/奖金/红包/退款/其他）
  - 成功页适配

- [ ] **T1.1.3** 设计设置页原型
  - 5个大菜单项
  - 字体大小调节
  - 模式切换入口
  - 数据备份入口

- [ ] **T1.1.4** 设计帮助页原型
  - 语音指引按钮
  - 图文教程卡片
  - 联系帮助入口

- [ ] **T1.1.5** 设计简化版报表页原型
  - 月度收支汇总
  - 分类占比饼图
  - 趋势折线图（简化版）

- [ ] **T1.1.6** 设计云同步页原型
  - 同步状态展示
  - 一键备份按钮
  - 恢复数据入口

### 1.2 功能解锁原型

- [ ] **T1.2.1** 设计功能货架页原型
  - 已解锁功能列表
  - 推荐解锁区域
  - 未解锁功能列表（带进度）

- [ ] **T1.2.2** 设计解锁推荐弹窗原型
  - 功能介绍
  - 推荐理由
  - 解锁/稍后按钮

- [ ] **T1.2.3** 设计解锁成功动画原型
  - 功能图标动画
  - 成就感反馈
  - 引导使用

### 1.3 模式切换原型

- [ ] **T1.3.1** 设计模式切换入口原型
  - 设置页切换开关
  - 切换确认弹窗
  - 模式介绍说明

- [ ] **T1.3.2** 设计模式切换过渡动画
  - 平滑过渡效果
  - 加载状态
  - 完成反馈

### 1.4 整合完整原型

- [ ] **T1.4.1** 整合所有傻瓜模式页面到 simple_mode_extended.html
- [ ] **T1.4.2** 创建 normal_mode_prototype.html 普通模式原型
- [ ] **T1.4.3** 创建 mode_switch_demo.html 模式切换演示
- [ ] **T1.4.4** 添加页面间导航和交互

**验证标准**：
- 所有原型页面可交互
- 页面间导航流畅
- 符合设计规范（字体、尺寸、颜色）

---

## 阶段2：核心架构实现 (P1)

### 2.1 模式管理基础

- [ ] **T2.1.1** 实现 `UIMode` 枚举和状态管理
  ```dart
  enum UIMode { ultraSimple, simple, advanced }
  ```

- [ ] **T2.1.2** 实现 `UIModeProvider` Riverpod Provider
  - 持久化存储当前模式
  - 模式切换方法
  - 模式变更监听

- [ ] **T2.1.3** 实现模式感知路由器 `ModeAwareRouter`
  - 根据当前模式返回对应页面
  - 路由回退机制

### 2.2 用户能力分析

- [ ] **T2.2.1** 定义用户行为数据模型 `UserBehaviorData`
  - 错误率
  - 任务完成速度
  - 求助次数
  - 功能探索率

- [ ] **T2.2.2** 实现行为数据收集服务 `BehaviorCollectorService`
  - 操作事件追踪
  - 错误事件追踪
  - 数据聚合

- [ ] **T2.2.3** 实现用户能力分析器 `UserCapabilityAnalyzer`
  - 能力等级计算算法
  - 定期评估机制

### 2.3 功能解锁系统

- [ ] **T2.3.1** 定义功能注册表 `FeatureRegistry`
  - 所有功能清单
  - 解锁条件定义
  - 功能依赖关系

- [ ] **T2.3.2** 实现功能状态仓库 `FeatureStateRepository`
  - 已解锁功能持久化
  - 解锁进度追踪

- [ ] **T2.3.3** 实现功能解锁引擎 `FeatureUnlockEngine`
  - 解锁条件检查
  - 推荐算法
  - 推荐理由生成

- [ ] **T2.3.4** 实现自适应节奏控制 `AdaptiveUnlockPacing`
  - 推荐频率控制
  - 条件倍数调整

**验证标准**：
- 单元测试覆盖率 ≥80%
- 模式切换无数据丢失
- 能力评估准确性验证

---

## 阶段3：傻瓜模式页面实现 (P1)

### 3.1 基础组件

- [ ] **T3.1.1** 实现 `SimpleModeScaffold` 统一页面框架
  - 大返回按钮
  - 语音按钮
  - 统一样式

- [ ] **T3.1.2** 实现 `MegaButton` 大按钮组件
  - 80dp高度
  - 图标+文字+描述
  - 触觉反馈

- [ ] **T3.1.3** 实现 `SimpleNumpad` 大数字键盘
  - 64dp按钮
  - 触觉反馈
  - 金额格式化

- [ ] **T3.1.4** 实现 `SimpleCategoryGrid` 分类选择网格
  - 8个固定分类
  - 大图标+文字
  - 选中状态

### 3.2 核心页面

- [ ] **T3.2.1** 实现 `SimpleModeHomePage` 首页
- [ ] **T3.2.2** 实现 `SimpleAmountPage` 金额输入页
- [ ] **T3.2.3** 实现 `SimpleCategoryPage` 分类选择页
- [ ] **T3.2.4** 实现 `SimpleSuccessPage` 成功页
- [ ] **T3.2.5** 实现 `SimpleStatsPage` 看账页
- [ ] **T3.2.6** 实现 `SimplePiggyPage` 存钱罐页
- [ ] **T3.2.7** 实现 `SimpleProfilePage` 我的页

### 3.3 扩展页面

- [ ] **T3.3.1** 实现 `SimpleTransactionListPage` 账单列表页
- [ ] **T3.3.2** 实现 `SimpleIncomePage` 收入记账页
- [ ] **T3.3.3** 实现 `SimpleSettingsPage` 设置页
- [ ] **T3.3.4** 实现 `SimpleHelpPage` 帮助页
- [ ] **T3.3.5** 实现 `SimpleReportPage` 简化报表页

**验证标准**：
- 所有页面符合傻瓜模式UI规范
- 语音反馈完整
- 触觉反馈完整
- Widget测试覆盖

---

## 阶段4：反馈系统实现 (P1)

### 4.1 语音反馈

- [ ] **T4.1.1** 实现 `VoiceFeedbackService` 语音服务
  - TTS初始化
  - 语音播报方法
  - 语音队列管理

- [ ] **T4.1.2** 定义语音文案库
  - 成功文案
  - 失败文案
  - 引导文案

### 4.2 触觉反馈

- [ ] **T4.2.1** 实现 `HapticFeedbackService` 触觉服务
  - 轻震/中震/重震
  - 双震模式
  - 平台适配

### 4.3 视觉反馈

- [ ] **T4.3.1** 实现成功动画组件
- [ ] **T4.3.2** 实现失败动画组件
- [ ] **T4.3.3** 实现加载动画组件

**验证标准**：
- 三种反馈同步触发
- 语音播报清晰
- 震动强度合适

---

## 阶段5：功能解锁UI实现 (P2)

### 5.1 功能货架

- [ ] **T5.1.1** 实现 `FeatureShelfPage` 功能货架页
  - 已解锁区域
  - 推荐区域
  - 未解锁区域

- [ ] **T5.1.2** 实现 `FeatureCard` 功能卡片组件
  - 功能图标和名称
  - 解锁进度条
  - 操作按钮

### 5.2 解锁流程

- [ ] **T5.2.1** 实现 `FeatureRecommendationDialog` 推荐弹窗
  - 功能介绍
  - 推荐理由
  - 解锁/稍后按钮

- [ ] **T5.2.2** 实现 `FeatureUnlockAnimation` 解锁动画
  - 成就感动画
  - 功能图标展示
  - 引导使用

- [ ] **T5.2.3** 实现推荐触发逻辑
  - 进入首页时检查
  - 满足条件时弹出
  - 频率控制

**验证标准**：
- 推荐时机准确
- 弹窗交互流畅
- 解锁后功能可用

---

## 阶段6：冷启动优化 (P2)

### 6.1 冷启动检测

- [ ] **T6.1.1** 实现 `ColdStartService` 冷启动服务
  - 检测是否首次使用
  - 判断是否准备好配置
  - 触发智能建议

### 6.2 智能配置

- [ ] **T6.2.1** 实现 `SmartConfigGenerator` 智能配置生成
  - 预算建议算法
  - 分类推荐算法
  - 默认值生成

- [ ] **T6.2.2** 实现 `SmartConfigDialog` 配置建议弹窗
  - 推荐预算展示
  - 多选项一键确认
  - 稍后再说选项

**验证标准**：
- 首次使用零配置
- 7天后智能建议准确
- 配置流程简单

---

## 阶段7：测试与优化 (P2)

### 7.1 用户测试

- [ ] **T7.1.1** 进行傻瓜模式可用性测试
  - 目标用户：65岁以上老人
  - 测试任务：完成一笔记账
  - 成功标准：首次成功率≥95%

- [ ] **T7.1.2** 进行模式切换测试
  - 测试数据一致性
  - 测试功能可用性
  - 测试切换流畅度

### 7.2 性能优化

- [ ] **T7.2.1** 优化模式切换性能（目标<500ms）
- [ ] **T7.2.2** 优化页面加载性能（目标<1s）
- [ ] **T7.2.3** 优化内存占用（增量<5MB）

### 7.3 文档

- [ ] **T7.3.1** 更新用户指南
- [ ] **T7.3.2** 更新开发文档
- [ ] **T7.3.3** 更新测试用例文档

**验证标准**：
- 所有测试指标达标
- 性能指标满足要求
- 文档完整

---

## 任务依赖关系

```
阶段1 (原型设计)
    ↓
阶段2 (核心架构) ←─┐
    ↓              │
阶段3 (页面实现) ──┤
    ↓              │
阶段4 (反馈系统) ──┘
    ↓
阶段5 (解锁UI)
    ↓
阶段6 (冷启动)
    ↓
阶段7 (测试优化)
```

## 优先级说明

- **P0**: 必须完成，阻塞后续工作
- **P1**: 核心功能，高优先级
- **P2**: 重要功能，中优先级
- **P3**: 可选优化，低优先级

## 并行工作建议

以下任务可以并行进行：
1. T1.1.x（原型页面）可以并行设计
2. T2.1.x（模式管理）和 T2.2.x（能力分析）可以并行
3. T3.1.x（基础组件）完成后，T3.2.x 和 T3.3.x 可以并行
4. T4.x（反馈系统）可以与 T3.x（页面实现）并行
